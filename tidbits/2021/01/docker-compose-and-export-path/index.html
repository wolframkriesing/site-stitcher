<!doctype html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="mobile-web-app-capable" content="yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="author" content="Wolfram Kriesing">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="picostitch - crafting (and) JavaScript">

    <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@wolframkriesing" />
  <meta name="twitter:title" content="docker-compose and Export $PATH" />

  <meta property="og:title" content="docker-compose and Export $PATH">
  <meta property="og:type" content="website">
<meta property="og:url" content="https://picostitch.com/tidbits/2021/01/docker-compose-and-export-path/">  <meta property="og:site_name" content="picostitch - crafting (and) JavaScript">

  <script async defer data-domain="picostitch.com" src="https://plausible.io/js/plausible.js"></script>
<link rel="canonical" href="https://picostitch.com/tidbits/2021/01/docker-compose-and-export-path/">  <title>docker-compose and Export $PATH | picostitch - crafting (and) JavaScript</title>

  <script async defer type="module" src="https://more-html.github.io/components/src/Heading-loader.js"></script>
  <link rel="stylesheet" href="/tidbits/tidbits.css" type="text/css">
  <meta property="article:type" content="article" />
    <meta property="article:tag" content="docker" />
    <meta property="article:tag" content="tools" />
    <meta property="article:tag" content="docker-compose" />
    <meta property="article:tag" content="containers" />

  <meta property="og:description" content="[All my projects use docker-compose](/tidbits/2021/01/docker-vs-docker-compose/).
In my setup I want every nodejs packages that provides an executable, such as `mocha` or `tsc`
to be available globally on the command line." />
  <meta property="article:description" content="[All my projects use docker-compose](/tidbits/2021/01/docker-vs-docker-compose/).
In my setup I want every nodejs packages that provides an executable, such as `mocha` or `tsc`
to be available globally on the command line." />
  <meta name="twitter:description" content="[All my projects use docker-compose](/tidbits/2021/01/docker-vs-docker-compose/).
In my setup I want every nodejs packages that provides an executable, such as `mocha` or `tsc`
to be available globally on the command line." />

    <meta property="og:image" content="https://picostitch.com/tidbits/2021/01/export-path-preview.jpeg" />
    <meta property="og:image:url" content="https://picostitch.com/tidbits/2021/01/export-path-preview.jpeg" />
    <meta name="twitter:image" content="https://picostitch.com/tidbits/2021/01/export-path-preview.jpeg" />
</head>
<body class="page-tidbit">

    <header>
    <nav class="primary">
        <ul>
      <li><a href="/">Home üè†</a></li>
      <li><a href="/blog">Blog ‚úçÔ∏è</a></li>
      <li><a href="/tidbits">Tidbits üòã</a></li>
      <li><a href="/projects">Projects üõ†‚Äç‚Äç</a></li>
      <li><a href="/about">About üí°</a></li>
  </ul>

    </nav>

    <div class="sitename">
      <a href="/">picostitch</a>
      <div class="subtitle">
        crafting (and) JavaScript
      </div>
    </div>
  </header>



  <nav class="breadcrumb">
  <a href="/">Home</a> &raquo;
  <a href="/tidbits/">Tidbits</a> &raquo;
  docker-compose and Export $PATH
  </nav>

  <main>
    <div class="content">
  <article>

      <img src="../export-path-preview.jpeg" style="width: 100%; height: 10rem; object-fit: cover;"/>

    <header>
      <div class="tag" data-tag="docker">#docker</div>
      <h1 id="docker-compose-and-export-path" is="more-h1">docker-compose and Export $PATH</h1>
      <div class="metadata">
        Wolfram Kriesing
        - January 8, 2021
          - tagged with: #docker #tools #docker-compose #containers       </div>
    </header>

    <p><a href="/tidbits/2021/01/docker-vs-docker-compose/">All my projects use docker-compose</a>.
In my setup I want every nodejs packages that provides an executable, such as <code>mocha</code> or <code>tsc</code>
to be available globally on the command line.</p>
<p>So I can type</p>
<pre><code class="undefinedshell-session">$ mocha
...</code></pre>
<p>I don&#39;t want to have to type the long version:</p>
<pre><code class="undefinedshell-session">$ ./node_module/.bin/mocha
...</code></pre>
<h2 is="more-h2" id="how-to-expose-nodejs-executables">How to Expose nodejs Executables?</h2>
<p>I don&#39;t want to <code>cd</code> into the project directory
and call the executable via <code>./node_module/.bin/mocha</code> or <code>./node_module/.bin/tsc</code> from there.
I can set this up by extending my machine&#39;s path like this <code>PATH=$PATH:./node_modules/.bin</code>.</p>
<p>The <a href="https://github.com/wolframkriesing/site-stitcher/blob/944038f503d8ae47c12de1982141dc8d9df6937a/Dockerfile#L3">according <code>Dockerfile</code></a> looks like this:</p>
<pre><code class="undefineddockerfile">FROM node
ENV PATH=$PATH:./node_modules/.bin</code></pre>
<h2 is="more-h2" id="define-path-export-in-docker-compose">Define Path Export in docker-compose</h2>
<p>I was searching the <a href="https://docs.docker.com/compose/compose-file/compose-file-v3/">docker-compose docs</a> but I could not find how to add a path to the existing path
inside a docker-compose setup. The typical docker-compose setup is stored in a <code>docker-compose.yml</code>
file and for nodejs it might look like this (very simplified):</p>
<pre><code class="undefinedyaml">version: &#39;3&#39;
services:
  picostitch:
    image: nodejs
    ports:
      - &quot;5000:5000&quot;
    volumes:
      - &#39;.:/app&#39;    </code></pre>
<p>see the <a href="https://github.com/wolframkriesing/site-stitcher/blob/76ba1541673a156d5cd944241ea7f29200fffeb5/docker-compose.yml">complete file running this blog, here</a>.</p>
<p>In a docker-compose you can configure (multiple) services. The one I need here is <code>picostitch</code>, which is
just a simple nodejs container, it exposes the port 5000 and maps the local directory <code>.</code> into the container
under <code>/app</code>.</p>
<p>Beside <code>ports</code>, <code>volumes</code> docker-compose also provides <code>environment</code> where one can define environment variables
to be set inside the running container. But I did not find a way to export a path.</p>
<h2 is="more-h2" id="use-docker-composes-build-option">Use docker-compose&#39;s <code>build</code> Option</h2>
<p>In this case I used the <code>build</code> option, which takes a directory where it looks for a <code>Dockerfile</code>, in which I set the 
path accordingly.</p>
<pre><code class="undefinedyaml">version: &#39;3&#39;
services:
  picostitch:
    build: .</code></pre>
<p>In the end I do use exactly the <code>Dockerfile</code> as mentioned above, so <strong>docker-compose</strong> can use it to build
my <strong>picostitch</strong> service.</p>
<pre><code class="undefineddockerfile">FROM node:15
ENV PATH=$PATH:./node_modules/.bin</code></pre>
<p>See the <a href="https://github.com/wolframkriesing/site-stitcher/tree/944038f503d8ae47c12de1982141dc8d9df6937a">files in the repo</a>;</p>
<h2 is="more-h2" id="multiple-containers">Multiple Containers</h2>
<p>When I have multiple containers that need a customized Dockerfile, I create a directory <code>docker-files/&lt;service-name&gt;</code>
where I put the <code>Dockerfile</code> in each directory. <strong>docker-compose</strong> also needs that for building the image in that
directory and use it as it&#39;s context.</p>

  </article>
    </div>
  </main>

    <footer>
    <div>
      <b>Pages</b>
        <ul>
      <li><a href="/">Home üè†</a></li>
      <li><a href="/blog">Blog ‚úçÔ∏è</a></li>
      <li><a href="/tidbits">Tidbits üòã</a></li>
      <li><a href="/projects">Projects üõ†‚Äç‚Äç</a></li>
      <li><a href="/about">About üí°</a></li>
  </ul>

    </div>

    <div>
      <b>Contact</b>
      <ul>
        <li><a href="https://twitter.com/wolframkriesing" rel="me">Twitter</a></li>
        <li><a href="https://codeberg.com/wolframkriesing" rel="me">Codeberg</a></li>
        <li><a href="https://github.com/wolframkriesing" rel="me">Github</a></li>
        <li><a href="mailto:w+through-picostitch-footer-contact@kriesing.de">Email</a></li>
      </ul>
    </div>
  </footer>

    <nav class="secondary">
    <div class="menu-button">&#9776;</div>
      <ul>
      <li><a href="/">Home üè†</a></li>
      <li><a href="/blog">Blog ‚úçÔ∏è</a></li>
      <li><a href="/tidbits">Tidbits üòã</a></li>
      <li><a href="/projects">Projects üõ†‚Äç‚Äç</a></li>
      <li><a href="/about">About üí°</a></li>
  </ul>

  </nav>

</body>
</html>
