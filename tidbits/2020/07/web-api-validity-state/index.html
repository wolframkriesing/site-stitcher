<!doctype html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="mobile-web-app-capable" content="yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="author" content="Wolfram Kriesing">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="picostitch - crafting (and) JavaScript">

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@wolframkriesing" />
  <meta name="twitter:title" content="Web API ValidityState" />

  <meta property="og:title" content="Web API ValidityState">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://picostitch.com/tidbits/2020/07/web-api-validity-state/">
  <meta property="og:site_name" content="picostitch - crafting (and) JavaScript">

  <link rel="stylesheet" href="/style.css" type="text/css">
  <script async defer data-domain="picostitch.com" src="https://plausible.io/js/plausible.js"></script>
  <script async defer type="module" src="https://more-html.github.io/components/src/Heading-loader.js"></script>
  <link rel="canonical" href="https://picostitch.com/tidbits/2020/07/web-api-validity-state/">
  <title>Web API ValidityState | picostitch - crafting (and) JavaScript</title>
  
<link rel="stylesheet" href="/tidbits/tidbits.css" type="text/css">

</head>
<body class="page-tidbit">
  





  <header>
    <nav class="primary">
      <ul>
        
          <li><a href="/">Home üè†</a></li>
        
          <li><a href="/tidbits">Tidbits üòã</a></li>
        
          <li><a href="/projects">Projects üõ†‚Äç‚Äç</a></li>
        
          <li><a href="/about">About üí°</a></li>
        
      </ul>
    </nav>

    <div class="sitename">
      <a href="/">picostitch</a>
      <div class="subtitle">
        crafting (and) JavaScript
      </div>
    </div>
  </header>

  <nav class="breadcrumb">
    
  <a href="/">Home</a> &raquo; <a href="/tidbits/">Tidbits</a> &raquo; Web API ValidityState

  </nav>

  <main>
    <div class="content">
      

  <article>
    <header>
      <div class="tag" data-tag="web">#web</div>
      <h1 id="web-api-validity-state" is="more-h1">Web API ValidityState</h1>
      <div class="metadata">
        Wolfram Kriesing
        - July 2, 2020
        
          - tagged with: #web #web API #learn #spec reading
        
      </div>
    </header>

    <p>It was the <a href="https://twitter.com/standardsbot">@standardsbot</a> that made me learn and look up
<a href="https://developer.mozilla.org/en-US/docs/Web/API/ValidityState">ValidityState</a>. While that bot tweets
weird stuff, there is always a learning in it. This time it was about ValidityState.</p>
<h2 is="more-h2" id="what-is-validitystate">What is <code>ValidityState</code>?</h2>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ValidityState">MDN describes it</a> as</p>
<blockquote>
<p>The <code>ValidityState</code> interface represents the validity states that an element can be in, 
with respect to constraint validation. Together, they help explain why an element&#39;s value 
fails to validate, if it&#39;s not valid.</p>
</blockquote>
<p>I have to say, that this indirect explanation of an &quot;interface&quot; might be totally correct, but
makes it harder to understand. One first needs to be sure to understand what an interface is.</p>
<h2 is="more-h2" id="the-html-spec-says">The HTML Spec Says</h2>
<p>In this case the <a href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#validitystate">explanation in the spec is much better</a>.</p>
<blockquote>
<p>A <code>ValidityState</code> object has the following attributes. On getting, they must return true 
if the corresponding condition given in the following list is true, and false otherwise.</p>
</blockquote>
<p>I think &quot;<code>ValidityState</code> object has the following attributes&quot; makes it so much better to understand.
Especially when you keep reading on. The spec explains it brief, short and explicit:</p>
<blockquote>
<p><code>valueMissing</code><br>The control is suffering from being missing.</p>
<p><code>typeMismatch</code><br>The control is suffering from a type mismatch.</p>
<p><code>patternMismatch</code><br>The control is suffering from a pattern mismatch.</p>
<p><code>tooLong</code><br>The control is suffering from being too long.</p>
<p><code>tooShort</code><br>The control is suffering from being too short.</p>
<p><code>rangeUnderflow</code><br>The control is suffering from an underflow.</p>
<p><code>rangeOverflow</code><br>The control is suffering from an overflow.</p>
<p><code>stepMismatch</code><br>The control is suffering from a step mismatch.</p>
<p><code>badInput</code><br>The control is suffering from bad input.</p>
<p><code>customError</code><br>The control is suffering from a custom error.</p>
<p><code>valid</code><br>None of the other conditions are true.</p>
</blockquote>
<p>So, don&#39;t be scared of specifications, they are sometimes really valuable, helpful and insightful.</p>
<h2 is="more-h2" id="what-are-these-attributes-for">What are these Attributes for?</h2>
<p>That&#39;s the question, I asked myself next.</p>
<p>The spec goes a bit abstract about it. I just pulled out three sentences that might need some
explanation.</p>
<blockquote>
<p>A submittable element is a candidate for <strong>constraint validation</strong>.<br>[...]<br>The <code>checkValidity()</code> method, when invoked, must run the <strong>check validity steps</strong> on this element.<br>[...]<br>An element satisfies its constraints if it is not suffering from any of the above <strong>validity states</strong>.</p>
</blockquote>
<p>If you read this again and again and let it sink in it might start making sense.
But it basically means (without being spec-exact) that you can call <code>checkValidity()</code>
on any form element, such as an <code>&lt;input&gt;</code> and it checks all the above listed attributes
of the ValidityState object. The attributes are all booleans, so the result of 
<code>checkValidity()</code> can be easily evaluated based on all values.</p>
<p>Open your browsers console and try out the following:</p>
<pre><code>&gt; document.querySelector(&#39;input&#39;).checkValidity()
true

&gt; document.querySelector(&#39;input&#39;).validity
ValidityState¬†{valueMissing: true, typeMismatch: false, patternMismatch: false, tooLong: false, tooShort: false,¬†‚Ä¶}</code></pre><p>This should give you a first good feeling for what the ValidityState consists of.
I assume you can already imagine use cases like better, more detailed validation messages and alikes for your next web app.</p>
<h2 is="more-h2" id="part-of-constraint-validation-api">Part of Constraint Validation API</h2>
<p>The <code>ValidityState</code> is part of <a href="https://developer.mozilla.org/en-US/docs/Web/API/Constraint_validation">Constraint Validation API</a>, 
so there is quite some more to it, which MDN describes as</p>
<blockquote>
<p>The Constraint Validation API enables checking values that users have entered into form controls, 
before submitting the values to the server.</p>
</blockquote>
<h2 is="more-h2" id="try-it-out">Try it out</h2>
<p>Since this is a web site, I think it makes sense to play around with it right on the site.
So try out below what kind of <code>ValidityState</code> attributes you get depending on an input field
with different attributes.</p>
<h2 is="more-h2" id="the-simple-input-typetext">The Simple <code>&lt;input type=text&gt;</code></h2>
<p>Simple text input with <strong>maxlength=3</strong>. Try to shorten the value down to three characters and see <code>tooLong</code> change.</p>
<ul>
<li><input disabled="" type="checkbox"> <code>&lt;input</code><strong><code>type=text</code></strong><code>maxlength=&quot;3&quot; value=&quot;12345&quot; /&gt;</code></li>
<li><input disabled="" type="checkbox"> <code>&lt;input</code><strong><code>type=text</code></strong><code>required /&gt;</code></li>
<li><input disabled="" type="checkbox"> <code>&lt;input</code><strong><code>type=text</code></strong><code>maxlength=&quot;3&quot; value=&quot;12345&quot; /&gt;</code></li>
<li><input disabled="" type="checkbox"> <code>&lt;input</code><strong><code>type=text</code></strong><code>maxlength=&quot;3&quot; value=&quot;12345&quot; /&gt;</code></li>
<li><input disabled="" type="checkbox"> <code>&lt;input</code><strong><code>type=text</code></strong><code>maxlength=&quot;3&quot; value=&quot;12345&quot; /&gt;</code></li>
<li><input disabled="" type="checkbox"> <code>&lt;input</code><strong><code>type=text</code></strong><code>maxlength=&quot;3&quot; value=&quot;12345&quot; /&gt;</code></li>
</ul>
<p><code>&lt;input type=</code>
<select id="select-input-type">
    <option>text</option>
    <option>button</option>
    <option>checkbox</option>
    <option>color</option>
    <option>date</option>
    <option>datetime-local</option>
    <option>email</option>
    <option>file</option>
    <option>image</option>
    <option>month</option>
    <option>number</option>
    <option>password</option>
    <option>radio</option>
    <option>range</option>
    <option>reset</option>
    <option>search</option>
    <option>submit</option>
    <option>tel</option>
    <option>text</option>
    <option>time</option>
    <option>url</option>
    <option>week</option>
</select>
required <input type=checkbox>
<code>&gt;</code></p>
<input id="validity-state-pure-input" type="text" maxlength="3" value="12345">
ValidityState: <pre><code id="validity-state-output"></code></pre>
<script type="application/javascript">
    const showValidity = (validity) => {
        const keys = Object.keys(ValidityState.prototype);
        const all = keys.reduce((all, key) => { all[key] = validity[key]; return all; }, {});
        document.querySelector('#validity-state-output').innerText = '> el.validity\n\n' + JSON.stringify(all, null, 4);
    };
    const el = document.querySelector('#validity-state-pure-input');    
    el.addEventListener('keyup', (evt) => {
        const validity = evt.target.validity;
        showValidity(validity);
    });
    showValidity(el.validity);
    document.querySelector('#select-input-type').addEventListener('change', ({target}) => {
        const newType = target.selectedOptions[0].value;
        el.setAttribute('type', newType);
        el.value = newType;
    });
</script>
  </article>

    </div>
    <aside class="right">
      
    </aside>
  </main>

  <footer>
    <div>
      <b>Pages</b><br/>
      <ul>
        
          <li><a href="/">Home üè†</a></li>
        
          <li><a href="/tidbits">Tidbits üòã</a></li>
        
          <li><a href="/projects">Projects üõ†‚Äç‚Äç</a></li>
        
          <li><a href="/about">About üí°</a></li>
        
      </ul>
    </div>
    <div>
      <b>Contact</b><br/>
      <ul>
        <li><a href="https://twitter.com/wolframkriesing" rel="me">Twitter</a><br/></li>
        <li><a href="https://codeberg.com/wolframkriesing" rel="me">Codeberg</a><br/></li>
        <li><a href="https://github.com/wolframkriesing" rel="me">Github</a><br/></li>
        <li><a href="mailto:w+through-picostitch-footer-contact@kriesing.de">Email</a><br/></li>
      </ul>
    </div>
    <div></div>
  </footer>
  <nav class="secondary">
    <div class="menu-button">&#9776;</div>
    <ul>
      
        <li><a href="/">Home üè†</a></li>
      
        <li><a href="/tidbits">Tidbits üòã</a></li>
      
        <li><a href="/projects">Projects üõ†‚Äç‚Äç</a></li>
      
        <li><a href="/about">About üí°</a></li>
      
    </ul>
  </nav>
</body>
</html>
